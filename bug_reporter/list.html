<!DOCTYPE html>
<html lang="KO">
	<head>
		<title>저장된 리포트 목록</title>
		<meta charset="UTF-8" />
		<script src="./xlsx.full.min.js"></script>
		<script src="./jszip.min.js"></script>

		<style>
			/* CSS는 이전과 동일하게 유지합니다 */
			body {
				font-family: sans-serif;
				background-color: #f4f4f9;
				margin: 0;
				padding: 2em;
			}
			.header {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 1em;
			}
			/* list.html 파일의 <style> 태그 안에 추가 */
			.dropdown {
				position: relative;
				display: inline-block;
			}
			.dropdown-toggle {
				background-color: #28a745;
				color: white;
				padding: 8px 12px;
				border: none;
				border-radius: 4px;
				cursor: pointer;
			}
			.dropdown-menu {
				display: none;
				position: absolute;
				background-color: #f9f9f9;
				min-width: 160px;
				box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
				z-index: 1;
				border-radius: 4px;
			}
			.dropdown-menu a {
				color: black;
				padding: 12px 16px;
				text-decoration: none;
				display: block;
			}
			.dropdown-menu a:hover {
				background-color: #f1f1f1;
			}
			.dropdown:hover .dropdown-menu {
				display: block;
			}
			h1 {
				color: #333;
				margin: 0;
			}
			.search-container {
				display: flex;
				gap: 0.5em;
			}
			#searchInput {
				padding: 8px 12px;
				font-size: 14px;
				border: 1px solid #ccc;
				border-radius: 4px;
				min-width: 300px;
			}
			.filter-container {
				margin-bottom: 1.5em;
			}
			.filter-container button {
				border: 1px solid #007bff;
				background-color: white;
				color: #007bff;
				padding: 6px 12px;
				margin-right: 5px;
				border-radius: 15px;
				cursor: pointer;
			}
			.filter-container button.active {
				background-color: #007bff;
				color: white;
			}
			table {
				width: 100%;
				border-collapse: collapse;
				background: white;
				box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
				table-layout: fixed;
			}
			th,
			td {
				padding: 12px 15px;
				border-bottom: 1px solid #ddd;
				text-align: left;
				vertical-align: middle;
				word-break: break-all;
			}
			th {
				background-color: #007bff;
				color: white;
			}
			.col-no {
				width: 4%;
			}
			.col-date {
				width: 13%;
			}
			.col-category {
				width: 8%;
			}
			.col-title {
				width: 18%;
			}
			.col-problem {
				width: auto;
			}
			.col-manage {
				width: 12%;
			}
			.col-status {
				width: 10%;
			}
			.status-select {
				width: 100%;
				padding: 4px;
				border-radius: 4px;
				border: 1px solid #ccc;
			}
			.modal {
				display: none;
				position: fixed;
				z-index: 1000;
				left: 0;
				top: 0;
				width: 100%;
				height: 100%;
				background-color: rgba(0, 0, 0, 0.6);
				/* 사용자가 큰 이미지를 스크롤 할 수 있도록 */
				overflow: auto;
			}
			.modal-content {
				background-color: #fefefe;
				margin: 5vh auto; /* 위아래 여백을 화면 높이의 5%로 설정 */
				padding: 25px;
				border-radius: 8px;
				box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
				/* ★★★ 핵심 변경점: 모달 크기를 화면의 90%로 설정 ★★★ */
				width: 90vw; /* 화면 너비의 90% */
				height: 80vh; /* 화면 높이의 90% */
				/* 내부 컨텐츠가 높이를 채우도록 flexbox 레이아웃 적용 */
				display: flex;
				flex-direction: column;
			}
			.modal-body {
				display: flex;
				gap: 20px;
				margin-top: 20px;
				/* ★★★ 추가: 남은 공간을 꽉 채우도록 설정 ★★★ */
				flex-grow: 1;
				/* 패널 내용이 많아질 경우를 대비해 스크롤 가능하게 */
				overflow: hidden;
			}
			.modal-image-panel {
				flex: 7;
				/* ★★★ 추가: 이미지가 커질 수 있도록 높이 제한 해제 ★★★ */
				overflow: auto; /* 이미지가 패널보다 크면 스크롤 생성 */
			}
			.modal-image-panel img {
				width: 100%; /* 패널 너비에 맞춤 */
				height: auto;
				display: block;
			}
			.modal-form-panel {
				flex: 3;
				/* ★★★ 추가: 폼 내용이 많아지면 스크롤 생성 ★★★ */
				overflow: auto;
				padding-right: 15px; /* 스크롤바 여백 */
			}
			.close-btn {
				color: #aaa;
				float: right;
				font-size: 28px;
				font-weight: bold;
				cursor: pointer;
			}
			.form-group {
				margin-bottom: 1em;
			}
			label {
				display: block;
				margin-bottom: 0.5em;
				font-weight: bold;
			}
			input,
			select,
			textarea {
				width: 100%;
				padding: 0.5em;
				box-sizing: border-box;
				border: 1px solid #ccc;
				border-radius: 4px;
			}
			textarea {
				min-height: 80px;
				resize: vertical;
			}
			#modalSaveBtn {
				padding: 10px 20px;
				background-color: #28a745;
				color: white;
				border: none;
				border-radius: 4px;
				cursor: pointer;
			}
			/* list.html 파일의 <style> 태그 안에 추가 */

			/* 라이트박스 스타일 */
			.lightbox {
				display: none;
				position: fixed;
				z-index: 2000; /* 기존 모달보다 위에 표시 */
				left: 0;
				top: 0;
				width: 100%;
				height: 100%;
				background-color: rgba(0, 0, 0, 0.85);
				overflow: auto;
				display: flex;
				align-items: center;
				justify-content: center;
			}
			.lightbox-content {
				margin: auto;
				display: block;
				max-width: none;
				max-height: none;
			}
			.lightbox-close {
				position: absolute;
				top: 20px;
				right: 40px;
				color: #f1f1f1;
				font-size: 40px;
				font-weight: bold;
				cursor: pointer;
			}
		</style>
	</head>
	<body>
		<div class="header">
			<h1>저장된 리포트 목록</h1>
			<div class="search-container">
				<input type="search" id="searchInput" placeholder="키워드로 검색..." />
				<div class="dropdown">
					<button id="exportBtn" class="dropdown-toggle">내보내기 ▾</button>
					<div class="dropdown-menu" id="exportMenu">
						<a href="#" data-format="excel" data-export-type="current"
							>현재 목록 내보내기</a
						>
						<a href="#" data-format="excel" data-export-type="new"
							>신규 항목 내보내기</a
						>
						<a href="#" data-format="excel" data-export-type="all"
							>전체 항목 내보내기</a
						>
						<hr />
						<a
							href="#"
							data-format="google-sheet"
							data-export-type="current"
							style="color: #999"
							>현재 목록 (Google Sheet)</a
						>
					</div>
				</div>
			</div>
		</div>
		<div
			style="
				text-align: right;
				margin: -1em 0 1em;
				font-size: 0.8em;
				color: #555;
			">
			마지막 내보내기: <span id="lastExportTime">없음</span>
		</div>
		<div class="filter-container" id="statusFilters"></div>
		<table>
			<thead>
				<tr>
					<th class="col-no">번호</th>
					<th class="col-date">캡처일자</th>
					<th class="col-category">분류</th>
					<th class="col-title">타이틀</th>
					<th class="col-problem">문제점 기술</th>
					<th class="col-manage">관리</th>
					<th class="col-status">상태</th>
				</tr>
			</thead>
			<tbody id="report-table-body"></tbody>
		</table>
		<p id="no-reports" style="display: none">저장된 리포트가 없습니다.</p>

		<div id="editModal" class="modal">
			<div class="modal-content">
				<span class="close-btn">&times;</span>
				<h2>리포트 상세 및 수정</h2>
				<div class="modal-body">
					<div class="modal-image-panel">
						<img id="modalImage" alt="Captured Image" />
					</div>
					<div class="modal-form-panel">
						<input type="hidden" id="modalReportId" />
						<div class="form-group">
							<label for="modalCategory">분류</label
							><select id="modalCategory">
								<option value="function">기능 오류</option>
								<option value="usability">사용성 개선</option>
								<option value="ui">UI 깨짐</option>
								<option value="typo">오탈자</option>
							</select>
						</div>
						<div class="form-group">
							<label for="modalTitle">제목</label
							><input type="text" id="modalTitle" />
						</div>
						<div class="form-group">
							<label for="modalProblem">문제점 기술</label
							><textarea id="modalProblem"></textarea>
						</div>
						<div class="form-group">
							<label for="modalExpected">원하는 결과</label
							><textarea id="modalExpected"></textarea>
						</div>
						<button id="modalSaveBtn">변경사항 저장</button>
					</div>
				</div>
			</div>
		</div>

		<script type="module" src="list.js"></script>
	</body>
</html>
